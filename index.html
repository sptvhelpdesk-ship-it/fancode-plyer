<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Live Sports Player</title>
  
  <!-- JW Player Library -->
  <script src="https://cdn.jwplayer.com/libraries/IDzF9Zmk.js"></script>

  <style>
    /* ‡¶™‡ßÅ‡¶∞‡ßã ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶® ‡¶ï‡¶æ‡¶≤‡ßã ‡¶è‡¶¨‡¶Ç ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶†‡¶ø‡¶ï ‡¶Æ‡¶æ‡¶ù‡¶ñ‡¶æ‡¶®‡ßá ‡¶∞‡¶æ‡¶ñ‡¶æ‡¶∞ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® */
    html, body { 
      margin: 0; 
      padding: 0;
      width: 100%; 
      height: 100%; 
      background: #000000; 
      display: flex; 
      justify-content: center; 
      align-items: center;
      overflow: hidden; 
    }
    
    #player-container {
      width: 100%;
      height: 100%;
    }

    /* ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡ßá‡¶∞ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® */
    #loading-overlay { 
      position: absolute; top:0; left:0; width:100%; height:100%; 
      background: #000000; display:flex; flex-direction:column; 
      justify-content:center; align-items:center; z-index:99999; 
      color:white; font-family:Arial, sans-serif; 
    }
    .spinner { 
      width:50px; height:50px; border:5px solid rgba(255,255,255,0.1); 
      border-top-color:#e94560; border-radius:50%; 
      animation:spin 1s linear infinite; margin-bottom:15px; 
    }
    @keyframes spin { to { transform: rotate(360deg); } }
  </style>
</head>
<body>

  <!-- ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶® -->
  <div id="loading-overlay">
    <div class="spinner"></div>
    <div id="loading-text">Loading Stream...</div>
  </div>

  <!-- ‡¶Æ‡ßá‡¶á‡¶® ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶™‡ßç‡¶≤‡ßá‡ßü‡¶æ‡¶∞ -->
  <div id="player-container">
    <div id="player"></div>
  </div>

  <script>
    const jsonUrl = 'https://raw.githubusercontent.com/Jitendra-unatti/fancode/refs/heads/main/data/fancode.json';
    const proxyBaseUrl = 'https://allinonereborn.online/fcww/live222.php?url=';
    const urlParams = new URLSearchParams(window.location.search);
    const matchId = urlParams.get('id');

    function showLoading(show, text="Loading...") {
      document.getElementById('loading-overlay').style.display = show ? 'flex' : 'none';
      if(show) document.getElementById('loading-text').innerText = text;
    }

    // ‡¶ï‡¶æ‡¶Å‡¶ö‡¶æ ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‡¶•‡ßá‡¶ï‡ßá ‡¶ï‡ßã‡ßü‡¶æ‡¶≤‡¶ø‡¶ü‡¶ø ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶≤‡¶ú‡¶ø‡¶ï
    function extractStreamUrls(text) {
      if(!text) return [];
      const lines = text.split('\n');
      const streams = [];
      
      for(let line of lines) {
        line = line.trim();
        if(line.startsWith('http')) {
          let q = 'Auto';
          if(line.includes('240p')) q='240p'; 
          else if(line.includes('360p')) q='360p'; 
          else if(line.includes('480p')) q='480p'; 
          else if(line.includes('540p')) q='540p'; 
          else if(line.includes('720p')) q='720p'; 
          else if(line.includes('1080p')) q='1080p';
          
          streams.push({
            url: line, 
            quality: q
          });
        }
      }
      return streams;
    }

    async function init() {
      if(!matchId) return showLoading(true, "Error: No Match ID provided");

      try {
        const res = await fetch(jsonUrl);
        const data = await res.json();
        const match = data.matches.find(m => m.match_id == matchId);
        
        if(!match) return showLoading(true, "Match Not Found");
        
        const rawText = match.auto_streams && match.auto_streams[0] ? match.auto_streams[0].auto : null;
        if(!rawText) return showLoading(true, "No Stream Data Available");
        
        const extractedStreams = extractStreamUrls(rawText);
        if(extractedStreams.length === 0) return showLoading(true, "Stream Not Available");

        // üü¢ JW Player-‡¶è‡¶∞ ‡¶®‡ßá‡¶ü‡¶ø‡¶≠ (Native) ‡¶∏‡ßã‡¶∞‡ßç‡¶∏ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ 
        const jwSources = extractedStreams.map(stream => {
          return {
            file: proxyBaseUrl + encodeURIComponent(stream.url),
            label: stream.quality,
            type: 'hls'
          };
        });

        // üü¢ ‡¶Æ‡ßá‡¶á‡¶® ‡¶™‡ßç‡¶≤‡ßá‡ßü‡¶æ‡¶∞ ‡¶∏‡ßá‡¶ü‡¶Ü‡¶™ 
        jwplayer('player').setup({
          sources: jwSources, // ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡¶¨ ‡¶ï‡ßã‡ßü‡¶æ‡¶≤‡¶ø‡¶ü‡¶ø ‡¶¶‡¶ø‡ßü‡ßá ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡¶≤‡ßã
          autostart: true,
          mute: false,
          width: '100%',
          height: '100%',
          stretching: 'uniform', // ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì‡¶ï‡ßá ‡¶†‡¶ø‡¶ï ‡¶Æ‡¶æ‡¶ù‡¶ñ‡¶æ‡¶®‡ßá ‡¶∏‡ßÅ‡¶®‡ßç‡¶¶‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶¨‡¶∏‡¶æ‡¶¨‡ßá
          primary: 'html5',
          hlshtml: true,
          cast: {} // ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶ø‡¶Ç ‡¶Ö‡¶™‡¶∂‡¶® ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶∞‡¶æ‡¶ñ‡¶≤‡¶æ‡¶Æ
        });

        // ‡¶™‡ßç‡¶≤‡ßá‡ßü‡¶æ‡¶∞ ‡¶∞‡ßá‡¶°‡¶ø ‡¶π‡¶≤‡ßá ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶® ‡¶∏‡¶∞‡¶ø‡ßü‡ßá ‡¶¶‡ßá‡¶¨‡ßá
        jwplayer('player').on('ready', () => {
          showLoading(false);
        });

        jwplayer('player').on('error', () => {
          showLoading(true, "Stream Error. Please reload.");
        });

      } catch(err) {
        showLoading(true, "Data Load Failed. Check network.");
      }
    }

    init();
  </script>

</body>
</html>
